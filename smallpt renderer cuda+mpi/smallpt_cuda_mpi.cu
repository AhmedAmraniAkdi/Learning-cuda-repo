// idea is to divide the samples between gpus using mpi
// on 1 gpu, we can take advante of multi process service

